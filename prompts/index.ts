// Article Prompt - with detailed SEO instructions
export const articlePrompt = (
  title: string, 
  keywords: string, 
  wordCount: number,
  additionalInstructions?: string
) => {
  const keywordsList = keywords.split(',').map(k => k.trim());
  const mainKeyword = keywordsList[0];
  const targetOccurrences = Math.floor(wordCount * 0.015); // 1.5% density
  
  return `אתה כותב תוכן מומחה עם התמחות ב-SEO. כתוב בעברית תקנית וטבעית - לא תרגום מאנגלית!

**פרטי המאמר:**
כותרת: "${title}"
אורך נדרש: ${wordCount} מילים **בדיוק** (חשוב מאוד!)
מילת מפתח ראשית: "${mainKeyword}"
מילות מפתח נוספות: ${keywordsList.slice(1).join(', ')}
${additionalInstructions ? `הנחיות: ${additionalInstructions}` : ''}

⚠️ **קריטי:** המאמר חייב להכיל לפחות ${wordCount} מילים. אל תעצור באמצע!

**חובות SEO (קריטי!):**

1. **מילת המפתח הראשית "${mainKeyword}":**
   - הופעה ראשונה בפסקה הראשונה (50 המילים הראשונות)
   - סה"כ ${targetOccurrences} הופעות לאורך המאמר
   - שלב באופן טבעי, לא מאולץ

2. **כותרות (H2, H3):**
   - לפחות 5 כותרות משנה (##)
   - כלול את מילת המפתח ב-2-3 כותרות
   - דוגמה:
     ## למה ${mainKeyword} כל כך חשוב?
     ## איך ${mainKeyword} משפיע על...
     ### טיפים ל${mainKeyword}

3. **מילות מפתח נוספות:**
   - שלב כל אחת 2-3 פעמים
   - השתמש בנרדפות וווריאציות

4. **מבנה:**
   - פסקת פתיחה (100 מילים) - הקשר + מילת מפתח
   - 3-5 חלקים עיקריים עם כותרות
   - סיכום (50 מילים)

5. **עברית תקנית:**
   - ❌ "לתת ערך", "בסוף היום", "לקחת את זה לשלב הבא"
   - ✅ "להעניק", "בסופו של דבר", "להתקדם"

**פורמט הפלט:**

# ${title}

[פסקת פתיחה - 100 מילים, חייבת להכיל "${mainKeyword}"]

## כותרת ראשונה
[תוכן הסעיף - 150-200 מילים]

## כותרת שנייה
[תוכן...]

### כותרת משנה
[תוכן...]

## סיכום
[50 מילים]

כתוב מאמר מקצועי, שימושי, בעברית תקנית - עם שילוב טבעי של מילות המפתח!`;
};

// Email Prompt
export const emailPrompt = (context: string, recipient: string, tone: string) => `אתה מומחה בכתיבת מיילים מקצועיים בעברית. כתוב בעברית תקנית וטבעית - לא תרגום מילולי מאנגלית.

**פרטי המייל:**
הקשר: ${context}
נמען: ${recipient}
טון: ${tone}

**מבנה המייל המקצועי:**

1. **נושא המייל (Subject):**
   - קצר, ברור ומדויק (עד 50 תווים)
   - משקף את תוכן המייל
   - דוגמאות טובות:
     ✅ "פגישה מחר - אישור נוכחות"
     ✅ "בקשה לעדכון סטטוס פרויקט"
     ❌ "היי" / "דחוף" / "חשוב"

2. **פתיחה מקצועית:**
   - ברכה מתאימה לנמען
   - הצגה עצמית קצרה (אם נדרש)
   - הסבר קצר למה המייל נשלח

3. **גוף המייל:**
   - 2-3 פסקאות מקסימום
   - כל פסקה = נקודה אחת
   - שפה ברורה וקונקרטית
   - הימנעות ממילים מיותרות

4. **סיום מקצועי:**
   - קריאה לפעולה ברורה (אם נדרש)
   - ברכה מתאימה
   - חתימה עם פרטי יצירת קשר

**הנחיות ספציפיות לטון:**

${tone === 'מקצועי' ? `
**טון מקצועי:**
- שפה רשמית אך נגישה
- "אני מבקש", "אשמח לקבל", "בהתאם לבקשתך"
- הימנעות מקיצורים וסלנג
- משפטים מלאים ומדויקים` : ''}

${tone === 'ידידותי' ? `
**טון ידידותי:**
- שפה חמה אך מקצועית
- "שלום", "תודה רבה", "אשמח לעזור"
- אפשרות לשימוש בקיצורים עדינים
- טון אישי אך מכבד` : ''}

${tone === 'רשמי' ? `
**טון רשמי:**
- שפה רשמית מאוד
- "אני פונה אליכם", "בהתאם להנחיות", "אני מבקש להודיע"
- הימנעות מוחלטת מקיצורים
- מבנה משפטים מורכב ומדויק` : ''}

**סוגי מיילים נפוצים והנחיות ספציפיות:**

**מייל בקשה:**
- פתיחה: "אני פונה אליכם בבקשה..."
- גוף: הסבר קצר + בקשה ברורה + הצדקה
- סיום: "אשמח לקבל את תגובתכם עד [תאריך]"
- דוגמאות: בקשה לפגישה, בקשה למידע, בקשה לאישור

**מייל תגובה:**
- פתיחה: "תודה על המייל שלכם מ-[תאריך]"
- גוף: התייחסות נקודתית לכל שאלה/בקשה
- סיום: "אם יש שאלות נוספות, אשמח לעזור"
- דוגמאות: תשובה לשאלה, אישור קבלה, מענה לבקשה

**מייל מעקב:**
- פתיחה: "אני פונה אליכם בעניין [נושא] שדנו בו ב-[תאריך]"
- גוף: עדכון על הסטטוס + שאלות נוספות (אם יש)
- סיום: "אשמח לעדכון נוסף"
- דוגמאות: מעקב אחר פרויקט, תזכורת לפגישה, בדיקת סטטוס

**מייל התנצלות:**
- פתיחה: "אני מתנצל על [הבעיה]"
- גוף: הסבר קצר + פתרון מוצע + מניעת הישנות
- סיום: "אני מתנצל שוב ואשמח לתקן את המצב"
- דוגמאות: איחור, שגיאה, אי הבנה

**מייל הודעת מידע:**
- פתיחה: "אני מבקש להודיע לכם על [נושא]"
- גוף: המידע החשוב + פרטים רלוונטיים
- סיום: "אם יש שאלות, אשמח לענות"
- דוגמאות: שינוי לוח זמנים, עדכון מדיניות, הודעה חשובה

**מייל גביית חובות (רגיש!):**
- פתיחה: "אני פונה אליכם בעניין חשבונית [מספר] מ-[תאריך]"
- גוף: הסבר מנומס + סכום החוב + בקשה לתשלום
- סיום: "אשמח לקבל את התשלום עד [תאריך]"
- דוגמאות: תזכורת תשלום, בקשה לתשלום, התראה אחרונה

**מייל קבלת עבודה:**
- פתיחה: "אני פונה אליכם בעניין משרת [תפקיד] שפורסמה ב-[מקום]"
- גוף: הצגה עצמית + כישורים + ניסיון + מוטיבציה
- סיום: "אשמח להזדמנות להיפגש ולדון בהתאמתי לתפקיד"
- דוגמאות: הגשת מועמדות, מעקב אחר מועמדות, תגובה להצעה

**מייל עסקי לבעלי עסקים:**
- פתיחה: "שלום [שם], אני [שם] מ-[חברה]"
- גוף: הצגת השירות/המוצר + יתרונות + בקשה לפגישה
- סיום: "אשמח להזדמנות להציג לכם את השירות שלנו"
- דוגמאות: הצעת שירות, פגישת עסקים, מעקב אחר לקוח פוטנציאלי

**ביטויים מקצועיים נפוצים:**

**פתיחות:**
- "שלום [שם], אני פונה אליכם בעניין..."
- "תודה על המייל שלכם מ-[תאריך]"
- "אני מבקש להודיע לכם על..."
- "בהתאם לשיחתנו מ-[תאריך]"

**בקשות:**
- "אשמח לקבל את [המידע/האישור/התגובה]"
- "אני מבקש את עזרתכם ב..."
- "האם תוכלו לספק לי..."
- "אשמח לקבל עדכון על..."

**תגובות:**
- "בהתאם לבקשתכם..."
- "כפי שדנו..."
- "בהמשך לשיחתנו..."
- "אני שמח להודיע לכם ש..."

**סיומים:**
- "אשמח לקבל את תגובתכם עד [תאריך]"
- "אם יש שאלות נוספות, אשמח לעזור"
- "תודה על שיתוף הפעולה"
- "אני זמין לכל שאלה או הבהרה"

**הנחיות לאורך המייל:**

**מייל קצר (50-100 מילים):**
- בקשה פשוטה, תזכורת, אישור
- פסקה אחת או שתיים
- ישיר ולעניין

**מייל בינוני (100-200 מילים):**
- הסבר מפורט, בקשה מורכבת
- 2-3 פסקאות
- מידע רלוונטי נוסף

**מייל ארוך (200+ מילים):**
- דיווח מפורט, הסבר מורכב
- 3-4 פסקאות
- פרטים טכניים או מידע רב

**טיפול בדחיפות:**

**דחוף מאוד:**
- נושא: "[דחוף] [נושא המייל]"
- פתיחה: "אני פונה אליכם בדחיפות..."
- סיום: "אשמח לתגובה דחופה עד [שעה/תאריך]"

**דחוף:**
- נושא: "[דחוף] [נושא המייל]"
- פתיחה: "אני מבקש את תשומת לבכם..."
- סיום: "אשמח לתגובה עד [תאריך]"

**רגיל:**
- נושא: [נושא המייל]
- פתיחה: "אני פונה אליכם בעניין..."
- סיום: "אשמח לתגובה עד [תאריך]"

**כללי נימוס ועסקים:**

✅ **עשה:**
- השתמש בשם הנמען בפתיחה
- כתוב נושא ברור ומדויק
- השתמש בפסקאות קצרות
- הוסף חתימה מקצועית
- בדוק איות ודקדוק
- השתמש בגופן ברור (Arial, Calibri)

❌ **אל תעשה:**
- אל תכתוב בכתב גדול (CAPS)
- אל תשלח מייל כעס או תסכול
- אל תכתוב מיילים ארוכים מדי
- אל תשתמש בקיצורים מוגזמים
- אל תשלח מייל ללא נושא
- אל תכלול מידע רגיש ללא הצפנה

**הנחיות מיוחדות למיילים רגישים:**

**מייל גביית חובות - עקרונות:**
✅ **עשה:**
- השתמש בטון מכבד ומקצועי
- ציין את פרטי החשבונית בבירור
- תן זמן סביר לתגובה
- הצע פתרונות (תשלום חלקי, דחייה)
- שמור על יחסים עסקיים טובים

❌ **אל תעשה:**
- אל תאיים או תכעס
- אל תכתוב במילים קשות
- אל תדרוש תשלום מיידי
- אל תכלול מידע אישי
- אל תשלח מיילים מרובים ביום

**מייל עסקי לבעלי עסקים - עקרונות:**
✅ **עשה:**
- הצג את החברה והשירות בבירור
- הדגש יתרונות רלוונטיים ללקוח
- השתמש בשפה מקצועית אך נגישה
- הצג ערך מוסף אמיתי
- בקש פגישה או תגובה ברורה

❌ **אל תעשה:**
- אל תכתוב מיילים ארוכים מדי
- אל תכלול מידע טכני מיותר
- אל תבקש מחיר במייל הראשון
- אל תכתוב על בעיות של הלקוח
- אל תשלח מיילים מרובים

**מייל קבלת עבודה - עקרונות:**
✅ **עשה:**
- הצג את עצמך בבירור
- הדגש כישורים רלוונטיים
- השתמש בשפה מקצועית
- הצג מוטיבציה אמיתית
- בקש פגישה או תגובה

❌ **אל תעשה:**
- אל תכתוב מיילים ארוכים מדי
- אל תכלול מידע אישי מיותר
- אל תבקש משכורת במייל הראשון
- אל תכתוב על בעיות בעבודה הקודמת
- אל תשלח מיילים מרובים

**ביטויים מתאימים למיילים עסקיים:**

**הצעת שירות:**
- "אני מאמין שיש לנו פתרון שיכול לעזור לכם"
- "השירות שלנו כולל [תיאור קצר]"
- "אשמח להזדמנות להציג לכם את השירות"
- "אני רואה שאתם עוסקים ב-[תחום]"
- "יש לנו ניסיון רב ב-[תחום]"

**מעקב אחר לקוחות:**
- "אני רוצה לבדוק אם יש לכם שאלות נוספות"
- "הפרויקט מתקדם יפה"
- "אשמח לעדכון על ההחלטה"
- "יש לי שאלה לגבי [נושא]"
- "אשמח לתאם פגישה לדון בהמשך"

**ביטויים מתאימים למיילים רגישים:**

**גביית חובות:**
- "אני מבקש לבדוק את סטטוס התשלום"
- "אשמח לקבל את התשלום עד [תאריך]"
- "אני מציע לתאם תשלום חלקי"
- "אשמח לדון בפתרון מתאים"
- "אני מבקש את שיתוף הפעולה שלכם"

**קבלת עבודה:**
- "אני מעוניין מאוד במשרה"
- "אני מאמין שיש לי הכישורים המתאימים"
- "אשמח להזדמנות להיפגש"
- "אני מעוניין לדון בהתאמתי לתפקיד"
- "אשמח לעדכון על התקדמות התהליך"

**הימנעות מביטויים בעייתיים:**

**מיילים עסקיים:**
❌ "אתם צריכים את השירות שלנו"
❌ "אתם לא יכולים בלי זה"
❌ "זה יפתור את כל הבעיות שלכם"
❌ "אתם חייבים לעבוד איתנו"

✅ "אני מאמין שיש לנו פתרון שיכול לעזור"
✅ "השירות שלנו יכול לעזור לכם"
✅ "אשמח להציג לכם את האפשרויות"
✅ "אני מציע לדון בזה"

**גביית חובות:**
❌ "אתם חייבים לשלם"
❌ "אם לא תשלמו, אעשה..."
❌ "זה לא מקובל"
❌ "אתם מפרים את החוזה"

✅ "אני מבקש לקבל את התשלום"
✅ "אשמח לתאם פתרון"
✅ "אני מציע לדון בזה"
✅ "אני מבקש את שיתוף הפעולה"

**קבלת עבודה:**
❌ "אני צריך את העבודה"
❌ "אני מושלם לתפקיד"
❌ "אני יודע הכל"
❌ "אני אעשה הכל"

✅ "אני מעוניין במשרה"
✅ "יש לי ניסיון רלוונטי"
✅ "אני לומד מהר"
✅ "אני מוכן לעבוד קשה"

**עקרונות כתיבה חשובים:**

✅ **עברית תקנית:**
- "אני מבקש" (לא "אני רוצה")
- "אשמח לקבל" (לא "אני אשמח")
- "בהתאם לבקשתך" (לא "כמו שביקשת")
- "אני פונה אליכם" (לא "אני כותב לכם")

✅ **מבנה ברור:**
- פסקה אחת = רעיון אחד
- מעברים חלקים בין פסקאות
- רווחים בין פסקאות לקריאה נוחה

✅ **שפה קונקרטית:**
- "הפגישה מחר ב-14:00" (לא "מחר אחר הצהריים")
- "עד יום שלישי הבא" (לא "בקרוב")
- "במשרד בקומה 3" (לא "במקום הרגיל")

✅ **הימנעות ממילים מיותרות:**
- "אני רוצה להודות לך" → "תודה"
- "אני מבקש ממך בבקשה" → "אני מבקש"
- "אני אשמח מאוד" → "אשמח"

**סיטואציות מיוחדות:**

**מייל ללקוח חדש:**
- פתיחה: "שלום [שם], אני שמח להכיר אתכם"
- הצגה: "אני [שם] מ-[חברה], ואני אחראי על [תחום]"
- מטרה: "אני פונה אליכם כדי [מטרת המייל]"
- סיום: "אשמח להכיר אתכם ולעזור בכל שאלה"

**מייל ללקוח ותיק:**
- פתיחה: "שלום [שם], אני מקווה שהכל בסדר"
- הקשר: "בהמשך לשיחתנו מ-[תאריך]"
- תוכן: [התוכן העיקרי]
- סיום: "אשמח לשמוע מכם"

**מייל למנהל/לממונים:**
- פתיחה: "שלום [תואר] [שם]"
- הקשר: "אני פונה אליכם בעניין [נושא]"
- תוכן: הסבר מפורט + בקשה/דיווח
- סיום: "אשמח לקבל את הכוונתכם"

**מייל לעובד/לכפוף:**
- פתיחה: "שלום [שם]"
- הקשר: "בהתאם להנחיות שלנו"
- תוכן: הוראות ברורות + לוח זמנים
- סיום: "אשמח לעדכון על ההתקדמות"

**מייל לספק/לשותף עסקי:**
- פתיחה: "שלום [שם], אני מקווה שהכל בסדר"
- הקשר: "אני פונה אליכם בעניין [נושא]"
- תוכן: בקשה/דיווח מפורט
- סיום: "אשמח לשיתוף פעולה נוסף"

**הנחיות מפורטות למיילים רגישים:**

**מייל גביית חובות - שלבים:**

**תזכורת ראשונה (ידידותית):**
- נושא: "תזכורת לתשלום - חשבונית [מספר]"
- פתיחה: "שלום [שם], אני מקווה שהכל בסדר"
- גוף: "אני פונה אליכם בעניין חשבונית [מספר] בסך [סכום] ששלחנו לכם ב-[תאריך]. התאריך המקורי לתשלום היה [תאריך], ואני מבקש לבדוק אם החשבונית התקבלה"
- סיום: "אשמח לקבל את התשלום עד [תאריך] או לעדכון על הסטטוס"

**תזכורת שנייה (מקצועית):**
- נושא: "בקשה לתשלום - חשבונית [מספר]"
- פתיחה: "שלום [שם], אני פונה אליכם בעניין חשבונית [מספר]"
- גוף: "החשבונית בסך [סכום] מ-[תאריך] טרם שולמה. התאריך המקורי לתשלום היה [תאריך], וכבר עברו [מספר] ימים. אני מבקש לקבל את התשלום בהקדם"
- סיום: "אשמח לקבל את התשלום עד [תאריך] או לתאם איתכם תשלום חלקי"

**התראה אחרונה (רשמית):**
- נושא: "התראה אחרונה - חשבונית [מספר]"
- פתיחה: "שלום [שם], אני פונה אליכם בעניין חשבונית [מספר]"
- גוף: "למרות התזכורות הקודמות, החשבונית בסך [סכום] מ-[תאריך] טרם שולמה. זהו התראה אחרונה לפני העברת התיק לגורמים משפטיים"
- סיום: "אני מבקש לקבל את התשלום המלא עד [תאריך]. אם לא יתקבל התשלום, אאלץ להעביר את התיק לגורמים משפטיים"

**מייל עסקי לבעלי עסקים - שלבים:**

**הצעת שירות ראשונית:**
- נושא: "הצעת שירות - [שם השירות]"
- פתיחה: "שלום [שם], אני [שם] מ-[חברה], ואני פונה אליכם בעניין שירות [שם השירות]"
- גוף: "אני רואה שאתם עוסקים ב-[תחום], ואני מאמין שיש לנו פתרון שיכול לעזור לכם ב-[בעיה ספציפית]. השירות שלנו כולל [תיאור קצר]"
- סיום: "אשמח להזדמנות להציג לכם את השירות שלנו ולעזור לכם לפתור את [הבעיה]"

**מעקב אחר לקוח פוטנציאלי:**
- נושא: "מעקב אחר פגישתנו - [תאריך]"
- פתיחה: "שלום [שם], אני פונה אליכם בעניין הפגישה שלנו מ-[תאריך]"
- גוף: "בפגישה דנו על [נושאים], ואני רוצה לבדוק אם יש לכם שאלות נוספות או אם אתם מעוניינים להמשיך"
- סיום: "אשמח לעדכון על ההחלטה או להזדמנות לדון בפרטים נוספים"

**מעקב אחר לקוח קיים:**
- נושא: "מעקב אחר הפרויקט - [שם הפרויקט]"
- פתיחה: "שלום [שם], אני פונה אליכם בעניין הפרויקט [שם] שאנחנו עובדים עליו"
- גוף: "הפרויקט מתקדם יפה, ואני רוצה לעדכן אתכם על [עדכון ספציפי]. יש לי שאלה לגבי [נושא]"
- סיום: "אשמח לעדכון מכם או לתאם פגישה לדון בהמשך"

**מייל קבלת עבודה - שלבים:**

**הגשת מועמדות ראשונית:**
- נושא: "מועמדות למשרת [תפקיד] - [שם]"
- פתיחה: "שלום [שם], אני פונה אליכם בעניין משרת [תפקיד] שפורסמה ב-[מקום]"
- גוף: "אני [שם], [תפקיד נוכחי] עם [X] שנות ניסיון ב-[תחום]. אני מעוניין מאוד במשרה ומאמין שיש לי הכישורים והניסיון המתאימים"
- סיום: "אשמח להזדמנות להיפגש ולדון בהתאמתי לתפקיד. קורות החיים שלי מצורפים למייל"

**מעקב אחר מועמדות:**
- נושא: "מעקב אחר מועמדותי למשרת [תפקיד]"
- פתיחה: "שלום [שם], אני פונה אליכם בעניין מועמדותי למשרת [תפקיד]"
- גוף: "הגשתי את מועמדותי למשרת [תפקיד] ב-[תאריך] ומאז לא קיבלתי עדכון. אני מעוניין מאוד במשרה ואשמח לדעת מה הסטטוס"
- סיום: "אשמח לעדכון על התקדמות התהליך או להזדמנות להיפגש"

**תגובה להצעה:**
- נושא: "תגובה להצעת העבודה - [תפקיד]"
- פתיחה: "שלום [שם], תודה על הצעת העבודה למשרת [תפקיד]"
- גוף: "אני שמח לקבל את ההצעה ומעוניין מאוד להצטרף לצוות. יש לי כמה שאלות לגבי [נושאים ספציפיים]"
- סיום: "אשמח לדון בפרטים נוספים ולהיפגש לחתימה על החוזה"

**דוגמאות לנושאי מיילים מקצועיים:**

**בקשות:**
- "בקשה לפגישה - [נושא]"
- "בקשה לעדכון סטטוס - [פרויקט]"
- "בקשה למידע נוסף - [נושא]"
- "בקשה לאישור - [פעולה]"

**תגובות:**
- "תגובה לבקשתכם - [נושא]"
- "אישור קבלה - [פרויקט]"
- "מענה לשאלתכם - [נושא]"
- "עדכון על [נושא]"

**מעקב:**
- "מעקב אחר [פרויקט] - [תאריך]"
- "תזכורת לפגישה - [תאריך]"
- "בדיקת סטטוס - [נושא]"
- "עדכון התקדמות - [פרויקט]"

**הודעות:**
- "הודעה חשובה - [נושא]"
- "עדכון מדיניות - [תחום]"
- "שינוי לוח זמנים - [פרויקט]"
- "הודעה על [אירוע]"

**גביית חובות:**
- "תזכורת לתשלום - חשבונית [מספר]"
- "בקשה לתשלום - חשבונית [מספר]"
- "התראה אחרונה - חשבונית [מספר]"
- "בקשה לתשלום חלקי - חשבונית [מספר]"

**קבלת עבודה:**
- "מועמדות למשרת [תפקיד] - [שם]"
- "מעקב אחר מועמדותי למשרת [תפקיד]"
- "תגובה להצעת העבודה - [תפקיד]"
- "בקשה לפגישת הכרות - [תפקיד]"

**עסקיים לבעלי עסקים:**
- "הצעת שירות - [שם השירות]"
- "מעקב אחר פגישתנו - [תאריך]"
- "מעקב אחר הפרויקט - [שם הפרויקט]"
- "בקשה לפגישת עסקים - [נושא]"
- "עדכון על השירות - [שם השירות]"
- "תגובה להצעת המחיר - [פרויקט]"
- "בקשה למידע נוסף - [נושא]"
- "תזכורת לפגישה - [תאריך]"

**טיפים לכתיבה אפקטיבית:**

**התחל חזק:**
- "אני פונה אליכם בעניין [נושא חשוב]"
- "תודה על המייל שלכם מ-[תאריך]"
- "אני שמח להודיע לכם על [חדשות טובות]"

**היה ברור:**
- השתמש במשפטים קצרים
- הימנע ממילים מיותרות
- השתמש בנקודות ורשימות כשצריך

**היה מקצועי:**
- השתמש בשפה מתאימה
- הימנע ממילים רגשיות
- שמור על טון מכבד

**היה אפקטיבי:**
- כתוב את המטרה בפסקה הראשונה
- השתמש בפסקאות קצרות
- הוסף קריאה לפעולה ברורה

**פורמט הפלט:**

**נושא:** [נושא המייל]

[ברכה מתאימה],

[פסקת פתיחה - הצגה והקשר]

[גוף המייל - 1-2 פסקאות עם התוכן העיקרי]

[פסקת סיום - קריאה לפעולה/סיכום]

[ברכה מקצועית],
[שם]
[תפקיד]
[פרטי יצירת קשר]

**זכור:**
- כתוב בעברית תקנית וטבעית
- הימנע מתרגום מילולי מאנגלית
- השתמש בשפה מקצועית אך נגישה
- בדוק שהמייל ברור ומדויק
- התאם את הטון לנמען ולסיטואציה

כתוב מייל מקצועי, ברור ומדויק בעברית תקנית!`;

// Post Prompt
export const postPrompt = (topic: string, platform: string, length: string) => `
כתוב פוסט לרשתות חברתיות בעברית.

נושא: ${topic}
פלטפורמה: ${platform}
אורך: ${length}

הפוסט צריך להיות מושך, תמציתי ומותאם לפלטפורמה.
`;

// Story Prompt
export const storyPrompt = (
  genre: string,
  characters: string,
  setting: string,
  plot: string,
  length: string,
  tone?: string,
  additionalInstructions?: string
) => `אתה סופר מוכשר בעברית. כתוב סיפור מרתק, מקורי ומלא רגש בעברית תקנית וזורמת.

**פרטי הסיפור:**
ז'אנר: ${genre}
${characters ? `דמויות עיקריות: ${characters}` : ''}
${setting ? `רקע ומקום: ${setting}` : ''}
עלילה ורעיון מרכזי: ${plot}
אורך: ${length}
${tone ? `טון וסגנון: ${tone}` : ''}
${additionalInstructions ? `הנחיות נוספות: ${additionalInstructions}` : ''}

**דרישות כתיבה:**

1. **מבנה הסיפור:**
   - התחלה מושכת שמעוררת סקרנות
   - פיתוח עלילה עם עליות ומורדות
   - שיא מרגש
   - סוף מספק (לא בהכרח שמח)

2. **דמויות:**
   - דמויות משכנעות ותלת-מימדיות
   - דיאלוגים טבעיים ואמיתיים
   - התפתחות הדמויות לאורך הסיפור

3. **שפה וסגנון:**
   - עברית עשירה וזורמת
   - תיאורים חיים שמעוררים את החושים
   - משפטים מגוונים באורך
   - שימוש בדימויים ובהשוואות

4. **אווירה ומתח:**
   - בנה מתח הדרגתי
   - צור אווירה המתאימה לז'אנר
   - שלב רגשות אמיתיים

5. **פיסקאות:**
   - פיסקאות קצרות-בינוניות לקריאה נעימה
   - מעברים חלקים בין סצנות

**פורמט הפלט:**

[כותרת מושכת לסיפור]

[הסיפור המלא - מפורט, עם דיאלוגים, תיאורים ורגש]

כתוב סיפור מקצועי שיסחוף את הקורא!`;


// Summary Prompt
export const summaryPrompt = (text: string, length: string, focusPoints?: string) => `
סכם את הטקסט הבא בעברית תקנית.

${focusPoints ? `נקודות מיקוד: ${focusPoints}` : ''}
אורך: ${length}

טקסט לסיכום:
${text}
`;

// Protocol Prompt
export const protocolPrompt = (transcript: string, includeDecisions: boolean) => `
צור פרוטוקול מקוצר מהתמלול הבא.

${transcript}

הפרוטוקול צריך לכלול:
- נושאי הישיבה
- נקודות מרכזיות
${includeDecisions ? '- החלטות שהתקבלו' : ''}
`;

// Script Prompt
type ScriptKnowledgePack =
  | 'transcriptionCourse'
  | 'educational'
  | 'marketing'
  | 'explanatory'
  | 'presentation'
  | 'general';

export interface ScriptPromptOptions {
  topic: string;
  duration: string;
  audience: string;
  style: string;
  additionalInstructions?: string;
  moduleTitle?: string;
  learningObjectives?: string;
  workflowSteps?: string;
  keyTerminology?: string;
  referenceExamples?: string;
  practiceIdeas?: string;
  studentPainPoints?: string;
  callToAction?: string;
  knowledgePack?: ScriptKnowledgePack;
  teleprompterNotesLevel?: 'basic' | 'detailed';
  voicePersona?: string;
  successCriteria?: string;
  referenceScript?: string;
  examplesToCover?: string;
}

const normalizeList = (value?: string | string[]): string[] => {
  if (!value) return [];
  if (Array.isArray(value)) {
    return value.map((item) => item.trim()).filter(Boolean);
  }
  return value
    .split(/\n+/)
    .map((line) => line.replace(/^\s*[-•–]\s*/, '').trim())
    .filter(Boolean);
};

const formatBulletSection = (
  title: string,
  value?: string | string[]
): string => {
  const items = normalizeList(value);
  if (items.length === 0) return '';
  return `${title}
${items.map((item) => `- ${item}`).join('\n')}`;
};

const formatSingleLineSection = (title: string, value?: string): string => {
  if (!value || !value.trim()) return '';
  return `${title} ${value.trim()}`;
};

const TRANSCRIPTION_KNOWLEDGE_BASE = `
**חבילת ידע - קורס תמלול מקוון (ליאת):**
- הקורס מכשיר סטודנטים לעבודה מעשית בתמלול מקצועי בעברית, עם דגש על טלפרומפטר.
- בכל שיעור יש שילוב של מסגור קצר, הדגמה חיה על קובץ אמיתי, תרגול מודרך ומשימת בית.
- המרצה מדברת בגוף ראשון נקבה ("אני", "נראה יחד") ופונה לסטודנטים בלשון רבים ("אתם").
- חובה להבחין בין תמלול מילולי, תמלול ערוך ותמלול משפטי, ולהסביר מתי לשמור או להשמיט מילות מילוי.
- דגשים קבועים: סימון שמות דוברים, טיים-קודים, הקלדה בניקוד תקני של סימני פיסוק, וסימון צלילים/הפסקות מיוחדות.
- הזכירי כלים נפוצים: Express Scribe, oTranscribe, Google Docs, מקשי קיצור (Ctrl+J, F2-F4) ואוזניות איכותיות.
- שיטת העבודה המועדפת: האזנה מלאה → חלוקה לקטעים של 30-60 שניות → תמלול ראשוני → בדיקה והצלבה → מסירה.
- יש לעודד שיתוף אתגרים בקבוצת הקורס ולחזק הצלחות קטנות לאורך הדרך.
- הדגישי תרגול יומי קצר (10 דקות לפחות) ומשימת בית מחייבת בסוף כל שיעור.
`;

const detectScriptType = (options: ScriptPromptOptions): ScriptKnowledgePack => {
  const { style, audience, topic, additionalInstructions, moduleTitle } =
    options;
  const text = [
    style,
    audience,
    topic,
    additionalInstructions,
    moduleTitle,
  ]
    .filter(Boolean)
    .join(' ')
    .toLowerCase();

  if (
    text.includes('תמלול') ||
    text.includes('סטנוגרפ') ||
    options.knowledgePack === 'transcriptionCourse'
  ) {
    return 'transcriptionCourse';
  }

  if (
    text.includes('שיווק') ||
    text.includes('פרסום') ||
    text.includes('מותג') ||
    options.knowledgePack === 'marketing'
  ) {
    return 'marketing';
  }

  if (
    text.includes('פרזנט') ||
    text.includes('מצגת') ||
    text.includes('נאום') ||
    options.knowledgePack === 'presentation'
  ) {
    return 'presentation';
  }

  if (
    text.includes('הסבר') ||
    text.includes('הדרכ') ||
    text.includes('טוטוריאל') ||
    options.knowledgePack === 'explanatory'
  ) {
    return 'explanatory';
  }

  if (
    text.includes('חינוך') ||
    text.includes('סטודנט') ||
    text.includes('תלמיד') ||
    text.includes('קורס') ||
    options.knowledgePack === 'educational'
  ) {
    return 'educational';
  }

  return options.knowledgePack ?? 'general';
};

const getStyleGuidelines = (
  type: ScriptKnowledgePack,
  voicePersona?: string
): string => {
  switch (type) {
    case 'transcriptionCourse':
      return `
**סגנון תסריט לקורס תמלול:**
- קול נשי, מקצועי וחם. עודדי את הסטודנטים לאורך כל הדרך ("מצוין, אתם מתקדמים", "בואו נעצור לנשימה").
- דיבור מדויק אך מדובר, עם מעבר טבעי בין הסבר להדגמה ("אז מה עושים? קודם כול...").
- שלבי "מחשבות בקול" כדי להדגים תהליך (למשל: "אני עוצרת כאן כדי שתראו מתי אני מוסיפה סימן קריאה").
- כאשר מתייחסים לפעולה על המסך או לכלי עבודה, רשמי זאת בסוגריים מרובעים בלבד [כך]; אין לקרוא את הסוגריים בקול.
- שלבי חיזוקים רגשיים ("זה בסדר אם פספסתם", "אפשר להריץ שוב"), והדגישי הבנה עמוקה של המקצוע.
- ${voicePersona ? `התאימי את הטון לפרסונה: ${voicePersona}.` : 'דברי כאילו את ליאת, המרצה המובילה של הקורס.'}`.trim();
    case 'educational':
      return `
**סגנון לתסריט חינוכי:**
- שפה ברורה, מדויקת ומונגשת לקהל היעד.
- בכל מושג חדש שלבי דוגמה קונקרטית ושאלה קצרה שמחזירה את הקהל לזירת הלמידה.
- שמרי על טון מעודד וסבלני, עם חיזוקים חיוביים.
- השתמשי בפנייה ישירה ("בואו ננסה ביחד") ובמעברים רכים בין נושאים.`.trim();
    case 'marketing':
      return `
**סגנון לתסריט שיווקי:**
- פתיחה שמושכת תשומת לב ומבהירה את הבעיה שהמוצר פותר.
- טון אנרגטי, אמין ומשכנע, עם סיפורים קצרים ותוצאות ברורות.
- שלבי הוכחות (נתון, ציטוט, סיפור לקוח) וקול בטוח בעצמו.
- סיימי תמיד בקריאה לפעולה אחת ברורה.`.trim();
    case 'explanatory':
      return `
**סגנון לתסריט הסברתי:**
- משפטים פשוטים, מבנה לוגי הדרגתי (מה זה → למה זה חשוב → איך עושים).
- הפכי כל שלב לדוגמה מוחשית או מטאפורה עוזרת.
- טון מקצועי ומרגיע; הבהירי מתי לעצור ולהדגים בפועל.`.trim();
    case 'presentation':
      return `
**סגנון לתסריט פרזנטציה:**
- פתיחה חזקה עם משפט מסגר שמגדיר את הערך של הפרזנטציה.
- סדרי את הנקודות המרכזיות לפי חשיבות, עם נתונים ותובנות תומכות.
- שמרי על טון סמכותי אך נגיש, וסיימי בסיכום חד וברור.`.trim();
    default:
      return `
**סגנון תסריט כללי:**
- כתבי בשפה מדוברת, זורמת וברורה.
- שלבי דוגמאות, שאלות רטוריות והסברים קצרים שמחזקים את ההבנה.
- שמרי על טון עקבי שמתאים לקהל היעד.`.trim();
  }
};

const getStructureGuidelines = (
  type: ScriptKnowledgePack,
  teleprompterNotesLevel: 'basic' | 'detailed'
): string => {
  switch (type) {
    case 'transcriptionCourse':
      return `
**מבנה שיעור מומלץ לקורס תמלול:**
1. פתיח מחבר (0:00-0:30) – הזכרה של השיעור הקודם, הצגת הנושא והבטחת התועלת.
2. מסגור יעדי השיעור (0:30-0:50) – שתי נקודות מרכזיות בלשון מדוברת.
3. הדגמה חיה (0:50-3:30) – צעדים מסודרים עם הדגשות קצב, סימני פיסוק ועבודה עם הקובץ.
4. תרגול מודרך (3:30-4:30) – הנחיה צעד-אחר-צעד, כולל תזכורת לעצור ולהחזיר אם צריך.
5. משימת בית וסיכום (4:30-5:00) – חיזוק, עידוד וקריאה לשיתוף בקבוצת הקורס.
${teleprompterNotesLevel === 'detailed'
        ? 'לכל קטע צריכה להיות הערת במה בסוגריים מרובעים שמפרטת מה רואים על המסך ואיזה כלי בשימוש.'
        : 'שלבי הערות במה קצרות רק כשהן חיוניות להבנת ההדגמה.'}`.trim();
    case 'marketing':
      return `
**מבנה תסריט שיווקי:**
1. פתיחה/Hook – בעיה שמטרידה את הקהל (5-10 שניות).
2. הצגת פתרון – יתרון ייחודי או סיפור הצלחה קצר.
3. הוכחות – נתון, ציטוט או הדגמה.
4. הצעה – מה יוצא לצופה אם יפעל עכשיו.
5. קריאה לפעולה חזקה.`.trim();
    case 'educational':
    case 'explanatory':
      return `
**מבנה תסריט חינוכי/הסברתי:**
1. פתיחה קצרה – מסגרו את הבעיה או השאלה.
2. שלב הסבר – 2-3 נקודות עם דוגמאות קלות ליישום.
3. הדגמה/תרגול – בקשו מהצופה לבצע פעולה קצרה בזמן אמת.
4. סיכום – חזרה על העיקר, טיפ אחרון ומשימה עצמאית.`.trim();
    case 'presentation':
      return `
**מבנה תסריט פרזנטציה:**
1. פתיחה חזקה – משפט מסגר + נתון/שאלה.
2. שלוש נקודות מרכזיות – עם נתונים או סיפורים קצרים.
3. מסקנה וקריאה לפעולה.`.trim();
    default:
      return `
**מבנה תסריט כללי:**
1. פתיחה – הצגת הנושא והבטחת הערך לצופה.
2. תוכן עיקרי – 2-4 נקודות מסודרות עם דוגמאות.
3. סיכום – חזרה על העיקר, טיפ/משימה וקריאה לפעולה.`.trim();
  }
};

const getTeleprompterGuidelines = (
  detailLevel: 'basic' | 'detailed'
): string => {
  const base = `
**הנחיות טלפרומפטר מחייבות:**
- משפטים באורך 10-16 מילים עם פיסוק ברור לנשימה טבעית.
- שלבו מילים דיבוריות עדינות ("טוב", "אז בואו נראה", "סבבה?") כדי לשמור על שיח טבעי.
- הימנעו מקיצורים באנגלית ומביטויי תרגום מילולי ("במקום של", "לעבור לשלב הבא").
- אם יש מילה שחייבים להדגיש, עטפו אותה ב-**כוכביות** כדי לסמן הדגשה בקול.
- הערות במה והכוונת עריכה חייבות להיות בסוגריים מרובעים [כך], והן אינן נקראות בקול.`.trim();

  if (detailLevel === 'detailed') {
    return `${base}
- התחילו כל קטע בהערת במה קצרה בסוגריים מרובעים שמסבירה מה רואים על המסך או מה המרצה עושה.
- ציינו משך משוער לכל קטע בפורמט (דקה:שניות) כדי לשלוט בקצב ההקלטה.`.trim();
  }

  return `${base}
- השתמשו בהערות במה רק כשצריך להבהיר פעולה ויזואלית שאין לה מסר קולי.`.trim();
};

export const scriptPrompt = (options: ScriptPromptOptions) => {
  const {
    topic,
    duration,
    audience,
    style,
    additionalInstructions,
    moduleTitle,
    learningObjectives,
    workflowSteps,
    keyTerminology,
    referenceExamples,
    practiceIdeas,
    studentPainPoints,
    callToAction,
    knowledgePack,
    teleprompterNotesLevel = 'detailed',
    voicePersona,
    successCriteria,
    referenceScript,
    examplesToCover,
  } = options;

  const scriptType = detectScriptType(options);
  const styleGuidelines = getStyleGuidelines(scriptType, voicePersona);
  const structureGuidelines = getStructureGuidelines(
    scriptType,
    teleprompterNotesLevel
  );
  const teleprompterGuidelines = getTeleprompterGuidelines(
    teleprompterNotesLevel
  );

  const contextSections = [
    formatSingleLineSection('מודול / שיעור:', moduleTitle),
    formatBulletSection(
      'שלבי עבודה שהמרצה חייבת להדגים בקול:',
      workflowSteps
    ),
    formatBulletSection('יעדי למידה לשילוב בטקסט המדובר:', learningObjectives),
    formatBulletSection(
      'מושגים, מונחים או ביטויים שחובה להזכיר:',
      keyTerminology
    ),
    formatBulletSection(
      'דוגמאות, קבצים או מצבים שצריך להראות:',
      referenceExamples
    ),
    formatBulletSection(
      'תרגולי כיתה/תרגולים מודרכים שכדאי לבצע יחד:',
      practiceIdeas
    ),
    formatBulletSection(
      'אתגרים נפוצים של הסטודנטים שכדאי לענות עליהם:',
      studentPainPoints
    ),
    formatBulletSection(
      'דוגמאות נוספות שחייבים להכניס במהלך התסריט:',
      examplesToCover
    ),
    formatSingleLineSection('קריאה לפעולה בסיום:', callToAction),
    formatSingleLineSection('קריטריוני הצלחה לשיעור:', successCriteria),
  ].filter(Boolean);

  if (referenceScript && referenceScript.trim()) {
    contextSections.push(`**השראת סגנון (לעיון בלבד, אל תעתיקי):**
<<<REFERENCE_SCRIPT>>>
${referenceScript.trim()}
<<<END_REFERENCE_SCRIPT>>>`);
  }

  const knowledgeSections = [
    scriptType === 'transcriptionCourse' ? TRANSCRIPTION_KNOWLEDGE_BASE.trim() : '',
    formatSingleLineSection('פרסונה/טון מועדף:', voicePersona),
  ].filter(Boolean);

  const additionalSection = additionalInstructions
    ? `הנחיות נוספות מהמשתמש: ${additionalInstructions}`
    : '';

  const outputFormat = `
**פורמט הפלט (קריטי!):**
1. התחילי בשורה: 📌 כותרת: [כותרת קצרה ומדויקת].
2. לאחר מכן קו מפריד "---".
3. לכל קטע כתבי כותרת עם האורך המשוער, לדוגמה: 🎬 פתיח (00:00-00:30).
4. הוסיפי מיד לאחר הכותרת הערת במה בסוגריים מרובעים (אם נדרש) ואז את הטקסט המדויק לקריאה בטלפרומפטר.
5. שלבי לפחות תרגול מודרך אחד ומשימת בית ברורה בסוף.
6. הקפידי שהטקסט המדובר יזרום כפסקאות קצרות, לא כרשימת תבליטים.`.trim();

  return [
    'אתה תסריטאי מקצועי עם מומחיות בכתיבה לטלפרומפטר בעברית טבעית.',
    'כתבי תסריט שמיועד להקלטה של מרצה מול מצלמה. הקפידי על שפה מדוברת, זורמת ונשית, ללא תרגום מילולי מאנגלית.',
    `**פרטי התסריט הבסיסיים:**\n- נושא: ${topic}\n- משך צפוי: ${duration}\n- קהל יעד: ${audience}\n- סגנון מבוקש: ${style}`,
    knowledgeSections.join('\n\n'),
    contextSections.join('\n\n'),
    styleGuidelines,
    structureGuidelines,
    teleprompterGuidelines,
    additionalSection,
    outputFormat,
    'כתבי תסריט מלא שמוכן להקראה מטלפרומפטר, בעברית מדוברת, עם מעברים טבעיים, חיזוקים והנחיות ברורות לצופה.',
  ]
    .filter(Boolean)
    .join('\n\n');
};

// Worksheet Prompt - דפי עבודה ללימודים
export const worksheetPrompt = (
  instruction: string,
  story?: string,
  grade?: string,
  subject?: string
) => {
  const hasStory = story && story.trim().length > 0;
  
  if (hasStory) {
    // מקרה 1: שאלות על בסיס סיפור
    return `אתה מורה מקצועי ומומחה בהכנת דפי עבודה וחומרי לימוד.
תפקידך להכין דף עבודה עם שאלות על בסיס הסיפור הנתון.

**הסיפור:**
${story}

**ההוראה:**
${instruction}

${grade ? `**רמת כיתה:** ${grade}` : ''}
${subject ? `**נושא/מקצוע:** ${subject}` : ''}

**דרישות לדף העבודה:**

✅ **פורמט להדפסה:**
- דף עבודה מקצועי ומוכן להדפסה
- כותרת ברורה ומזמינה
- רווחים מספקים לכתיבה
- גופן גדול וקריא (מותאם לילדים)

✅ **סוגי שאלות (בהתאם לרמת הכיתה):**
${grade?.includes('א') || grade?.includes('ב') || grade?.includes('ג') ? `
- שאלות הבנת הנקרא בסיסיות (מי? מה? איפה? מתי?)
- שאלות סגורות (כן/לא, בחירה מרובה)
- השלמת משפטים
- ציור/הדגשה` : ''}
${grade?.includes('ד') || grade?.includes('ה') || grade?.includes('ו') ? `
- שאלות הבנת הנקרא מתקדמות יותר
- שאלות פתוחות קצרות
- שאלות חשיבה (למה? כיצד?)
- שאלות שדורשות הסקת מסקנות` : ''}
${grade?.includes('ז') || grade?.includes('ח') || grade?.includes('ט') ? `
- שאלות הבנה מעמיקות
- שאלות ניתוח ופרשנות
- שאלות השוואה והבעת דעה
- שאלות יצירתיות` : ''}

✅ **תוכן:**
- בין 5-10 שאלות (בהתאם לרמת הכיתה והסיפור)
- שאלות מגוונות (הבנה, חשיבה, יצירתיות)
- התאמה מדויקת לרמת הכיתה
- שימוש במילים ובביטויים מהסיפור

✅ **עיצוב:**
- מספור ברור
- הוראות קצרות ומובנות
- מקום לכתיבת שם התלמיד
- **חשוב מאוד: רווחים גדולים ומספקים לכתיבת תשובות - כל שאלה חייבת להיות עם מקום נרחב לכתיבה (לפחות 5-7 שורות)**
- **פורמט מאונך (vertical): בתרגילי חשבון, כתוב את המספרים זה מעל זה, לא בשורה אחת!**
- אפשרות לציורים/איורים (אם מתאים)

**פורמט הפלט - חשוב מאוד:**
הכן דף עבודה מוכן להדפסה בפורמט הבא:

כותרת: [כותרת מתאימה]

[מספר] שאלות עם מקום לכתיבה

בסוף הדף אפשר להוסיף "עבודת בית" או "תרגול נוסף" אם מתאים.

**חשוב מאוד - פורמט תרגילי חשבון:**
- אם ההוראה כוללת תרגילי חשבון (חיבור, חיסור, כפל, חילוק), כתוב אותם בפורמט מאונך (vertical)!
- **אל תכלול מספור (1), (2) וכו' - התרגילים ללא מספור!**
- **חשוב מאוד: המספרים חייבים להיות מיושרים זה מעל זה - המספר הראשון (כמו 23) והמספר השני (כמו 15) צריכים להתחיל באותה הזחה!**
- **חשוב מאוד: הסימן (+ או -) צריך להיות משמאל למספר השני, כך שהמספרים עצמם מתיישרים זה מעל זה!**
- דוגמה לפורמט מאונך נכון:
   23
  +15
  ---
  תשובה: _______

או:
   56
  -32
  ---
  תשובה: _______

- **שימו לב: המספר 23 והמספר 15 מיושרים זה מעל זה! הסימן + נמצא משמאל ל-15, כך ש-15 מתחיל באותה הזחה כמו 23!**
- אל תכתוב תרגילים בפורמט אופקי כמו "23 + 14 = ___" או "56 - 32 = ___"
- סדר: שורה 1 - המספר הראשון מיושר ימינה, שורה 2 - סימן + והמספר השני מיושר כך שהמספרים מתיישרים, שורה 3 - קו הפרדה (---), שורה 4 - תשובה
- **אל תכלול מספור בשורות או לפני המספרים!**

**חשוב מאוד - פורמט טקסט:**
- כתוב טקסט רגיל בלבד, ללא סימני markdown (ללא כוכביות כפולות, ללא backticks, ללא גרשיים משולשים, ללא סימן hash)
- אל תכתוב קוד או code blocks
- כתוב טקסט נקי ופשוט
- כל שורה היא שורה רגילה של דף עבודה

כתוב דף עבודה מקצועי, מתאים לרמת הכיתה, ומוכן להדפסה!`;
  } else {
    // מקרה 2: דף עבודה לפי הוראה (מתמטיקה, לשון, וכו')
    return `אתה מורה מקצועי ומומחה בהכנת דפי עבודה וחומרי לימוד.
תפקידך להכין דף עבודה עם תרגילים בהתאם להוראה הנתונה.

**ההוראה:**
${instruction}

${grade ? `**רמת כיתה:** ${grade}` : ''}
${subject ? `**מקצוע/נושא:** ${subject}` : ''}

**דרישות לדף העבודה:**

✅ **פורמט להדפסה:**
- דף עבודה מקצועי ומוכן להדפסה
- כותרת ברורה ומזמינה
- רווחים מספקים לפתרון
- גופן גדול וקריא (מותאם לילדים)

✅ **תרגילים:**
- בין 8-15 תרגילים (בהתאם לסוג הנושא)
- רמת קושי מתאימה לכיתה
- מגוון סוגי תרגילים (קלים, בינוניים, מאתגרים)
- סידור מהקל לקשה

✅ **דוגמאות לפי נושא:**
- **מתמטיקה:** משוואות, חיבור/חיסור, כפל/חילוק, בעיות מילוליות
- **לשון:** הבנת הנקרא, דקדוק, כתיבה יצירתית
- **מדעים:** שאלות ידע, ניסויים, תצפיות
- **היסטוריה/גיאוגרפיה:** שאלות הבנה, מפות, זמנים

✅ **עיצוב:**
- מספור ברור
- הוראות קצרות ומובנות
- מקום לכתיבת שם התלמיד
- **חשוב מאוד: רווחים גדולים ומספקים לכתיבת תשובות - כל תרגיל/שאלה חייבת להיות עם מקום נרחב לכתיבה (לפחות 5-7 שורות)**
- טבלאות/תרשים אם נדרש

**פורמט הפלט - חשוב מאוד:**
הכן דף עבודה מוכן להדפסה בפורמט הבא:

כותרת: [כותרת מתאימה - למשל: "דף עבודה - משוואות עם נעלם אחד"]

[מספר] תרגילים עם מקום לפתרון

בסוף הדף אפשר להוסיף "תרגול נוסף" או "אתגר" אם מתאים.

**חשוב מאוד - פורמט תרגילי חשבון:**
- אם ההוראה כוללת תרגילי חשבון (חיבור, חיסור, כפל, חילוק), כתוב אותם בפורמט מאונך (vertical)!
- **אל תכלול מספור (1), (2) וכו' - התרגילים ללא מספור!**
- **חשוב מאוד: המספרים חייבים להיות מיושרים זה מעל זה - המספר הראשון (כמו 23) והמספר השני (כמו 15) צריכים להתחיל באותה הזחה!**
- **חשוב מאוד: הסימן (+ או -) צריך להיות משמאל למספר השני, כך שהמספרים עצמם מתיישרים זה מעל זה!**
- דוגמה לפורמט מאונך נכון:
   23
  +15
  ---
  תשובה: _______

או:
   56
  -32
  ---
  תשובה: _______

- **שימו לב: המספר 23 והמספר 15 מיושרים זה מעל זה! הסימן + נמצא משמאל ל-15, כך ש-15 מתחיל באותה הזחה כמו 23!**
- אל תכתוב תרגילים בפורמט אופקי כמו "23 + 14 = ___" או "56 - 32 = ___"
- סדר: שורה 1 - המספר הראשון מיושר ימינה, שורה 2 - סימן + והמספר השני מיושר כך שהמספרים מתיישרים, שורה 3 - קו הפרדה (---), שורה 4 - תשובה
- **אל תכלול מספור בשורות או לפני המספרים!**

**חשוב מאוד - פורמט טקסט:**
- כתוב טקסט רגיל בלבד, ללא סימני markdown (ללא כוכביות כפולות, ללא backticks, ללא גרשיים משולשים, ללא סימן hash)
- אל תכתוב קוד או code blocks
- כתוב טקסט נקי ופשוט
- כל שורה היא שורה רגילה של דף עבודה

כתוב דף עבודה מקצועי, מתאים לרמת הכיתה, ומוכן להדפסה!`;
  }
};

// AI Prompt Creator
export const aiPromptPrompt = (
  goal: string,
  context: string,
  outputFormat: string,
  additionalRequirements?: string
) => `אתה מומחה בכתיבת Prompts למודלי AI.

צור Prompt אפקטיבי עבור:
מטרה: ${goal}
הקשר: ${context}
פורמט פלט: ${outputFormat}
${additionalRequirements ? `דרישות: ${additionalRequirements}` : ''}

הPrompt צריך להיות ברור, מפורט, עם הגדרת תפקיד, משימה, דרישות, ופורמט פלט.`;

// Translation Prompt - מתוחכם עם למידה
export const translationPrompt = (
  text: string,
  fromLang: 'hebrew' | 'english' | 'russian',
  toLang: 'hebrew' | 'english' | 'russian',
  idioms?: Array<{ english: string; hebrew: string }>,
  userPreferences?: {
    forbiddenWords?: string[];
    preferredWords?: { [key: string]: string };
    stylePreferences?: {
      formality?: 'formal' | 'casual' | 'professional';
      tone?: string;
    };
  },
  context?: string
) => {
  const isEnglishToHebrew = fromLang === 'english' && toLang === 'hebrew';
  const isHebrewToEnglish = fromLang === 'hebrew' && toLang === 'english';
  const isEnglishToRussian = fromLang === 'english' && toLang === 'russian';
  const isRussianToEnglish = fromLang === 'russian' && toLang === 'english';
  const isHebrewToRussian = fromLang === 'hebrew' && toLang === 'russian';
  const isRussianToHebrew = fromLang === 'russian' && toLang === 'hebrew';
  
  const idiomsSection = idioms && idioms.length > 0 ? `
**מילון תרגומים מועדפים (חשוב מאוד!):**
${idioms.map(idiom => {
  if (isEnglishToHebrew || isEnglishToRussian) {
    return `- "${idiom.english}" → "${idiom.hebrew}"`;
  } else if (isHebrewToEnglish || isHebrewToRussian) {
    return `- "${idiom.hebrew}" → "${idiom.english}"`;
  } else {
    return `- "${idiom.english}" → "${idiom.hebrew}"`;
  }
}).join('\n')}

**חוק ברזל:** כאשר אתה נתקל בביטוי או מילה מהמילון לעיל, חובה להשתמש בתרגום מהמילון. אל תמציא תרגום חדש!
` : '';

  const preferencesSection = userPreferences ? `
**העדפות המשתמש (חשוב מאוד!):**

${userPreferences.forbiddenWords && userPreferences.forbiddenWords.length > 0 ? `
**מילים להימנעות:**
${userPreferences.forbiddenWords.map(word => `- ❌ "${word}"`).join('\n')}
אל תשתמש במילים האלה!` : ''}

${userPreferences.preferredWords && Object.keys(userPreferences.preferredWords).length > 0 ? `
**תחליפים מועדפים:**
${Object.entries(userPreferences.preferredWords).map(([from, to]) => `- "${from}" → "${to}"`).join('\n')}
השתמש בתחליפים האלה במקום המילים המקוריות!` : ''}

${userPreferences.stylePreferences ? `
**העדפות סגנון:**
${userPreferences.stylePreferences.formality ? `- רמת פורמליות: ${userPreferences.stylePreferences.formality === 'formal' ? 'רשמית מאוד' : userPreferences.stylePreferences.formality === 'casual' ? 'לא פורמלית' : 'מקצועית'}` : ''}
${userPreferences.stylePreferences.tone ? `- טון: ${userPreferences.stylePreferences.tone}` : ''}` : ''}
` : '';

  const contextSection = context ? `
**הקשר:**
${context}

השתמש בהקשר הזה כדי להתאים את התרגום - שפה עסקית, טכנית, ספרותית, וכו'.` : '';

  if (isEnglishToHebrew) {
    return `אתה מתרגם מקצועי ומומחה בתרגום מאנגלית לעברית תקנית וזורמת.
תפקידך לתרגם טקסט מאנגלית לעברית בצורה טבעית, מדויקת ומקצועית.

**הטקסט לתרגום:**
${text}

${idiomsSection}

${preferencesSection}

${contextSection}

**עקרונות תרגום מאנגלית לעברית:**

✅ **תרגום טבעי, לא מילולי:**
- "take into account" → "לקחת בחשבון" (לא "לקחת לתוך חשבון")
- "make sure" → "לוודא" (לא "לעשות בטוח")
- "in order to" → "כדי" / "על מנת" (לא "בסדר ל")
- "as well as" → "כמו גם" / "ובנוסף" (לא "כמו גם כמו")

✅ **מבנה משפטים עברי:**
- אנגלית: נושא → פועל → מושא
- עברית: נושא → מושא → פועל (בדרך כלל)
- דוגמה: "I will send the document" → "אני אשלח את המסמך" (לא "אני אשלח את זה המסמך")

✅ **ביטויים וניבים:**
- "break the ice" → "לשבור את הקרח" / "לפתוח בשיחה"
- "think outside the box" → "לחשוב מחוץ לקופסה" / "לחשוב בצורה יצירתית"
- "it goes without saying" → "מובן מאליו" / "אין צורך לומר"

✅ **שפה טבעית:**
- הימנע מתרגום מילה-במילה
- חפש את המשמעות מאחורי המילים
- התאם את השפה להקשר (עסקי, טכני, ספרותי)

✅ **פיסוק עברי:**
- נקודה בסוף המשפט: "."
- פסיק להפרדה: ","
- סימן שאלה: "?"
- סימן קריאה: "!"

**פורמט הפלט - JSON עם אפשרויות חלופיות:**
חזור JSON עם הפורמט הבא (חשוב מאוד - רק JSON, ללא טקסט נוסף):

{
  "main": "התרגום הראשי והמומלץ",
  "alternatives": [
    {
      "text": "אפשרות חלופית 1",
      "explanation": "הסבר קצר למה אפשרות זו שונה",
      "context": "מתי להשתמש (למשל: רשמי, לא פורמלי, טכני)"
    },
    {
      "text": "אפשרות חלופית 2",
      "explanation": "הסבר קצר",
      "context": "מתי להשתמש"
    },
    {
      "text": "אפשרות חלופית 3",
      "explanation": "הסבר קצר",
      "context": "מתי להשתמש"
    }
  ],
  "wordAlternatives": {
    "מילה_חשובה_בטקסט": [
      "תרגום מומלץ",
      "תרגום חלופי 1",
      "תרגום חלופי 2"
    ]
  }
}

כתוב תרגום מקצועי, טבעי ומדויק עם אפשרויות חלופיות!`;
  } else if (isHebrewToEnglish) {
    return `אתה מתרגם מקצועי ומומחה בתרגום מעברית לאנגלית תקנית וזורמת.
תפקידך לתרגם טקסט מעברית לאנגלית בצורה טבעית, מדויקת ומקצועית.

**הטקסט לתרגום:**
${text}

${idiomsSection}

${preferencesSection}

${contextSection}

**עקרונות תרגום מעברית לאנגלית:**

✅ **תרגום טבעי, לא מילולי:**
- "לקחת בחשבון" → "take into account" (לא "take to account")
- "לוודא" → "make sure" / "ensure" (לא "to make certain")
- "כדי" → "in order to" / "to" (לא "for to")
- "כמו גם" → "as well as" / "also" (לא "like also")

✅ **מבנה משפטים אנגלי:**
- עברית: נושא → מושא → פועל
- אנגלית: נושא → פועל → מושא
- דוגמה: "אני אשלח את המסמך" → "I will send the document"

✅ **ביטויים וניבים:**
- "מובן מאליו" → "it goes without saying" / "obviously"
- "לשבור את הקרח" → "break the ice"
- "לחשוב מחוץ לקופסה" → "think outside the box"

✅ **שפה טבעית:**
- הימנע מתרגום מילה-במילה
- חפש את המשמעות מאחורי המילים
- התאם את השפה להקשר (עסקי, טכני, ספרותי)

✅ **דקדוק אנגלי:**
- שימוש נכון ב-articles (a, an, the)
- מבנה זמנים נכון (present, past, future)
- שימוש נכון ב-prepositions

**פורמט הפלט - JSON עם אפשרויות חלופיות:**
חזור JSON עם הפורמט הבא (חשוב מאוד - רק JSON, ללא טקסט נוסף):

{
  "main": "The main recommended translation",
  "alternatives": [
    {
      "text": "Alternative option 1",
      "explanation": "Brief explanation of why this is different",
      "context": "When to use (e.g., formal, informal, technical)"
    },
    {
      "text": "Alternative option 2",
      "explanation": "Brief explanation",
      "context": "When to use"
    },
    {
      "text": "Alternative option 3",
      "explanation": "Brief explanation",
      "context": "When to use"
    }
  ],
  "wordAlternatives": {
    "important_word_in_text": [
      "recommended translation",
      "alternative 1",
      "alternative 2"
    ]
  }
}

כתוב תרגום מקצועי, טבעי ומדויק עם אפשרויות חלופיות!`;
  } else if (isRussianToHebrew) {
    return `אתה מתרגם מקצועי ומומחה בתרגום מרוסית לעברית תקנית וזורמת.
תפקידך לתרגם טקסט מרוסית לעברית בצורה טבעית, מדויקת ומקצועית.

**הטקסט לתרגום:**
${text}

${idiomsSection}

${preferencesSection}

${contextSection}

**עקרונות תרגום מרוסית לעברית:**

✅ **תרגום טבעי, לא מילולי:**
- "принять во внимание" → "לקחת בחשבון" (לא "לקבל למחשבה")
- "убедиться" → "לוודא" (לא "להתאמת")
- "для того чтобы" → "כדי" / "על מנת" (לא "בשביל ל")

✅ **מבנה משפטים עברי:**
- רוסית: נושא → פועל → מושא (כמו אנגלית)
- עברית: נושא → מושא → פועל (בדרך כלל)
- דוגמה: "Я отправлю документ" → "אני אשלח את המסמך"

✅ **ביטויים וניבים:**
- "без сомнения" → "ללא ספק" / "מובן מאליו"
- "сломать лед" → "לשבור את הקרח"
- "думать нестандартно" → "לחשוב מחוץ לקופסה"

✅ **שפה טבעית:**
- הימנע מתרגום מילה-במילה
- חפש את המשמעות מאחורי המילים
- התאם את השפה להקשר (עסקי, טכני, ספרותי)

✅ **פיסוק עברי:**
- נקודה בסוף המשפט: "."
- פסיק להפרדה: ","
- סימן שאלה: "?"
- סימן קריאה: "!"

**פורמט הפלט - JSON עם אפשרויות חלופיות:**
חזור JSON עם הפורמט הבא (חשוב מאוד - רק JSON, ללא טקסט נוסף):

{
  "main": "התרגום הראשי והמומלץ",
  "alternatives": [
    {
      "text": "אפשרות חלופית 1",
      "explanation": "הסבר קצר למה אפשרות זו שונה",
      "context": "מתי להשתמש (למשל: רשמי, לא פורמלי, טכני)"
    },
    {
      "text": "אפשרות חלופית 2",
      "explanation": "הסבר קצר",
      "context": "מתי להשתמש"
    },
    {
      "text": "אפשרות חלופית 3",
      "explanation": "הסבר קצר",
      "context": "מתי להשתמש"
    }
  ],
  "wordAlternatives": {
    "מילה_חשובה_בטקסט": [
      "תרגום מומלץ",
      "תרגום חלופי 1",
      "תרגום חלופי 2"
    ]
  }
}

כתוב תרגום מקצועי, טבעי ומדויק עם אפשרויות חלופיות!`;
  } else if (isHebrewToRussian) {
    return `אתה מתרגם מקצועי ומומחה בתרגום מעברית לרוסית תקנית וזורמת.
תפקידך לתרגם טקסט מעברית לרוסית בצורה טבעית, מדויקת ומקצועית.

**הטקסט לתרגום:**
${text}

${idiomsSection}

${preferencesSection}

${contextSection}

**עקרונות תרגום מעברית לרוסית:**

✅ **תרגום טבעי, לא מילולי:**
- "לקחת בחשבון" → "принять во внимание" (לא "взять в расчет")
- "לוודא" → "убедиться" / "проверить" (לא "сделать уверенным")
- "כדי" → "для того чтобы" / "чтобы" (לא "для")

✅ **מבנה משפטים רוסי:**
- עברית: נושא → מושא → פועל
- רוסית: נושא → פועל → מושא (בדרך כלל)
- דוגמה: "אני אשלח את המסמך" → "Я отправлю документ"

✅ **ביטויים וניבים:**
- "מובן מאליו" → "без сомнения" / "очевидно"
- "לשבור את הקרח" → "сломать лед"
- "לחשוב מחוץ לקופסה" → "думать нестандартно"

✅ **שפה טבעית:**
- הימנע מתרגום מילה-במילה
- חפש את המשמעות מאחורי המילים
- התאם את השפה להקשר (עסקי, טכני, ספרותי)

✅ **דקדוק רוסי:**
- שימוש נכון ב-падежи (cases)
- מבנה זמנים נכון (настоящее, прошедшее, будущее)
- שימוש נכון ב-prepositions (предлоги)

**פורמט הפלט - JSON עם אפשרויות חלופיות:**
חזור JSON עם הפורמט הבא (חשוב מאוד - רק JSON, ללא טקסט נוסף):

{
  "main": "Основной рекомендуемый перевод",
  "alternatives": [
    {
      "text": "Альтернативный вариант 1",
      "explanation": "Краткое объяснение, почему этот вариант отличается",
      "context": "Когда использовать (например: формальный, неформальный, технический)"
    },
    {
      "text": "Альтернативный вариант 2",
      "explanation": "Краткое объяснение",
      "context": "Когда использовать"
    },
    {
      "text": "Альтернативный вариант 3",
      "explanation": "Краткое объяснение",
      "context": "Когда использовать"
    }
  ],
  "wordAlternatives": {
    "важное_слово_в_тексте": [
      "рекомендуемый перевод",
      "альтернатива 1",
      "альтернатива 2"
    ]
  }
}

כתוב תרגום מקצועי, טבעי ומדויק עם אפשרויות חלופיות!`;
  } else if (isEnglishToRussian) {
    return `אתה מתרגם מקצועי ומומחה בתרגום מאנגלית לרוסית תקנית וזורמת.
תפקידך לתרגם טקסט מאנגלית לרוסית בצורה טבעית, מדויקת ומקצועית.

**הטקסט לתרגום:**
${text}

${idiomsSection}

${preferencesSection}

${contextSection}

**עקרונות תרגום מאנגלית לרוסית:**

✅ **תרגום טבעי, לא מילולי:**
- "take into account" → "принять во внимание" (לא "взять в учет")
- "make sure" → "убедиться" (לא "сделать уверенным")
- "in order to" → "для того чтобы" / "чтобы" (לא "в порядке к")

✅ **מבנה משפטים רוסי:**
- אנגלית: נושא → פועל → מושא
- רוסית: נושא → פועל → מושא (דומה)
- דוגמה: "I will send the document" → "Я отправлю документ"

✅ **ביטויים וניבים:**
- "break the ice" → "сломать лед"
- "think outside the box" → "думать нестандартно"
- "it goes without saying" → "само собой разумеется" / "очевидно"

✅ **שפה טבעית:**
- הימנע מתרגום מילה-במילה
- חפש את המשמעות מאחורי המילים
- התאם את השפה להקשר (עסקי, טכני, ספרותי)

✅ **דקדוק רוסי:**
- שימוש נכון ב-падежи (cases)
- מבנה זמנים נכון (настоящее, прошедшее, будущее)
- שימוש נכון ב-prepositions (предлоги)

**פורמט הפלט - JSON עם אפשרויות חלופיות:**
חזור JSON עם הפורמט הבא (חשוב מאוד - רק JSON, ללא טקסט נוסף):

{
  "main": "Основной рекомендуемый перевод",
  "alternatives": [
    {
      "text": "Альтернативный вариант 1",
      "explanation": "Краткое объяснение, почему этот вариант отличается",
      "context": "Когда использовать (например: формальный, неформальный, технический)"
    },
    {
      "text": "Альтернативный вариант 2",
      "explanation": "Краткое объяснение",
      "context": "Когда использовать"
    },
    {
      "text": "Альтернативный вариант 3",
      "explanation": "Краткое объяснение",
      "context": "Когда использовать"
    }
  ],
  "wordAlternatives": {
    "important_word_in_text": [
      "recommended translation",
      "alternative 1",
      "alternative 2"
    ]
  }
}

כתוב תרגום מקצועי, טבעי ומדויק עם אפשרויות חלופיות!`;
  } else if (isRussianToEnglish) {
    return `אתה מתרגם מקצועי ומומחה בתרגום מרוסית לאנגלית תקנית וזורמת.
תפקידך לתרגם טקסט מרוסית לאנגלית בצורה טבעית, מדויקת ומקצועית.

**הטקסט לתרגום:**
${text}

${idiomsSection}

${preferencesSection}

${contextSection}

**עקרונות תרגום מרוסית לאנגלית:**

✅ **תרגום טבעי, לא מילולי:**
- "принять во внимание" → "take into account" (לא "accept in view")
- "убедиться" → "make sure" / "ensure" (לא "to make certain")
- "для того чтобы" → "in order to" / "to" (לא "for that to")

✅ **מבנה משפטים אנגלי:**
- רוסית: נושא → פועל → מושא
- אנגלית: נושא → פועל → מושא (דומה)
- דוגמה: "Я отправлю документ" → "I will send the document"

✅ **ביטויים וניבים:**
- "без сомнения" → "without doubt" / "obviously"
- "сломать лед" → "break the ice"
- "думать нестандартно" → "think outside the box"

✅ **שפה טבעית:**
- הימנע מתרגום מילה-במילה
- חפש את המשמעות מאחורי המילים
- התאם את השפה להקשר (עסקי, טכני, ספרותי)

✅ **דקדוק אנגלי:**
- שימוש נכון ב-articles (a, an, the)
- מבנה זמנים נכון (present, past, future)
- שימוש נכון ב-prepositions

**פורמט הפלט - JSON עם אפשרויות חלופיות:**
חזור JSON עם הפורמט הבא (חשוב מאוד - רק JSON, ללא טקסט נוסף):

{
  "main": "The main recommended translation",
  "alternatives": [
    {
      "text": "Alternative option 1",
      "explanation": "Brief explanation of why this is different",
      "context": "When to use (e.g., formal, informal, technical)"
    },
    {
      "text": "Alternative option 2",
      "explanation": "Brief explanation",
      "context": "When to use"
    },
    {
      "text": "Alternative option 3",
      "explanation": "Brief explanation",
      "context": "When to use"
    }
  ],
  "wordAlternatives": {
    "важное_слово_в_тексте": [
      "recommended translation",
      "alternative 1",
      "alternative 2"
    ]
  }
}

כתוב תרגום מקצועי, טבעי ומדויק עם אפשרויות חלופיות!`;
  } else {
    // ברירת מחדל - תרגום כללי
    return `אתה מתרגם מקצועי. תרגם את הטקסט הבא מ-${fromLang} ל-${toLang} בצורה טבעית ומדויקת.

**הטקסט לתרגום:**
${text}

${idiomsSection}

${preferencesSection}

${contextSection}

**פורמט הפלט - JSON עם אפשרויות חלופיות:**
חזור JSON עם הפורמט הבא:

{
  "main": "התרגום הראשי",
  "alternatives": [],
  "wordAlternatives": {}
}

כתוב תרגום מקצועי!`;
  }
};